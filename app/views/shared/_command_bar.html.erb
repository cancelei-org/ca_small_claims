<div data-controller="command-bar">
  <dialog data-command-bar-target="dialog" 
          aria-labelledby="command-bar-title"
          class="modal items-start pt-[20vh] backdrop:bg-black/50">
    
    <div class="modal-box p-0 w-full max-w-lg bg-base-100 shadow-2xl rounded-xl overflow-hidden border border-base-content/10">
    <h3 id="command-bar-title" class="sr-only">Command Bar</h3>
    <!-- Search Input -->
    <div class="border-b border-base-200 p-4 flex items-center gap-3">
      <svg class="w-5 h-5 text-base-content/50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
      </svg>
      <input type="text" 
             data-command-bar-target="input"
             data-action="input->command-bar#search"
             class="w-full bg-transparent border-none outline-none text-lg placeholder-base-content/40" 
             placeholder="<%= t("command_bar.placeholder") %>">
      <span class="text-xs font-mono text-base-content/40 border border-base-content/20 rounded px-1.5 py-0.5">ESC</span>
    </div>

    <!-- Results List -->
    <div class="max-h-[60vh] overflow-y-auto p-2 scrollbar-hide" data-command-bar-target="results">
      
      <!-- Navigation Group -->
      <div class="mb-2">
        <div class="text-xs font-semibold text-base-content/40 px-3 py-2 uppercase tracking-wider"><%= t("command_bar.navigation") %></div>
        
        <button type="button" 
                data-command-bar-target="item"
                data-action="click->command-bar#select"
                data-url="<%= root_path %>"
                class="w-full text-left flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-base-200 group transition-colors">
          <svg class="w-5 h-5 text-base-content/50 group-hover:text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
          <span class="flex-1"><%= t("command_bar.go_home") %></span>
        </button>

        <button type="button" 
                data-command-bar-target="item"
                data-action="click->command-bar#select"
                data-url="<%= forms_path %>"
                class="w-full text-left flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-base-200 group transition-colors">
          <svg class="w-5 h-5 text-base-content/50 group-hover:text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
          </svg>
          <span class="flex-1"><%= t("command_bar.browse_forms") %></span>
        </button>
      </div>

      <!-- Actions Group -->
      <div class="mb-2">
        <div class="text-xs font-semibold text-base-content/40 px-3 py-2 uppercase tracking-wider"><%= t("command_bar.actions") %></div>
        
        <button type="button" 
                data-command-bar-target="item"
                data-action="click->command-bar#select"
                data-command-bar-action="theme"
                class="w-full text-left flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-base-200 group transition-colors">
          <svg class="w-5 h-5 text-base-content/50 group-hover:text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
          </svg>
          <span class="flex-1"><%= t("command_bar.switch_theme") %></span>
        </button>

        <button type="button" 
                data-command-bar-target="item"
                data-action="click->command-bar#select"
                data-command-bar-action="copy-link"
                class="w-full text-left flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-base-200 group transition-colors">
          <svg class="w-5 h-5 text-base-content/50 group-hover:text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m-1 4h.01M9 16h.01" />
          </svg>
          <span class="flex-1">Copy Link</span>
        </button>

        <button type="button" 
                data-command-bar-target="item"
                data-action="click->command-bar#select"
                data-command-bar-action="clear-form"
                class="w-full text-left flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-base-200 group transition-colors">
          <svg class="w-5 h-5 text-base-content/50 group-hover:text-error" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
          </svg>
          <span class="flex-1 text-error">Clear Form</span>
        </button>
      </div>

    </div>
    
    <!-- Footer -->
    <div class="bg-base-200/50 p-2 text-xs text-base-content/50 text-center border-t border-base-200">
      <span class="hidden md:inline">
        <kbd class="kbd kbd-sm">↑</kbd> <kbd class="kbd kbd-sm">↓</kbd> <%= t("command_bar.navigate") %> • <kbd class="kbd kbd-sm">↵</kbd> <%= t("command_bar.select") %>
      </span>
      <span class="md:hidden"><%= t("command_bar.tap_select") %></span>
    </div>
  </div>

  <form method="dialog" class="modal-backdrop">
    <button data-action="click->command-bar#close">close</button>
  </form>
</dialog>

<%# Mobile Floating Action Button (FAB) %>
<button type="button" 
        data-action="click->command-bar#open"
        class="fixed bottom-6 left-6 btn btn-circle btn-primary btn-lg shadow-xl z-40 md:hidden min-w-[56px] min-h-[56px] transition-transform active:scale-95"
        aria-label="Quick Actions">
  <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
  </svg>
</button>
</div>
